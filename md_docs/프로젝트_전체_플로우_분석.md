# ë‰´ëŸ° tES ì‹œë®¬ë ˆì´ì…˜ í”„ë¡œì íŠ¸ ì „ì²´ í”Œë¡œìš° ë¶„ì„

## ğŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”

ì´ í”„ë¡œì íŠ¸ëŠ” **ì „ê¸°ìê·¹(tES, Transcranial Electrical Stimulation)ì— ëŒ€í•œ ë‰´ëŸ° ë°˜ì‘ì„ ì‹œë®¬ë ˆì´ì…˜**í•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤. Ansysì—ì„œ ê³„ì‚°ëœ ì „ê¸°ì¥(E-field) ë°ì´í„°ë¥¼ NEURON ì‹œë®¬ë ˆì´í„°ì— ì ìš©í•˜ì—¬ ì¼ì§ì„  í¥ë¶„ì„± ë‰´ëŸ°ì˜ ë°˜ì‘ì„ ë¶„ì„í•©ë‹ˆë‹¤.

---

## ğŸ”„ ì „ì²´ í”Œë¡œìš° ë‹¤ì´ì–´ê·¸ë¨

```
[Ansys ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼]
    â†“
[twin_cons_cathodicfirst_400us_100Hz_single10ms_Ex/Ez í´ë”]
    â†“ (1ì‚¬ì´í´ = 201ê°œ íŒŒì¼, 10ms, 50us ê°„ê²©)
[Singlecycletoncycle_npyextractor.ipynb]
    â†“ (40ì‚¬ì´í´ë¡œ í™•ì¥)
[E_field_40cycles.npy] (Shape: 2, 14641, 8040)
    â†“
[extract_coords.py]
    â†“ (ì¢Œí‘œ ì¶”ì¶œ)
[E_field_grid_coords.npy] (Shape: 14641, 3)
    â†“
[Extractedfilecheck.py]
    â†“ (ë°ì´í„° ê²€ì¦)
[simulate_tES.py]
    â†“ (NEURON ì‹œë®¬ë ˆì´ì…˜)
[simulate_tES_output/] (ê²°ê³¼ ê·¸ë˜í”„)
```

---

## ğŸ“ íŒŒì¼ë³„ ìƒì„¸ ë¶„ì„

### 1. **Singlecycletoncycle_npyextractor.ipynb** 
**ì—­í• **: Ansys í…ìŠ¤íŠ¸ íŒŒì¼ë“¤ì„ ë¡œë“œí•˜ì—¬ 40ì‚¬ì´í´ë¡œ í™•ì¥í•œ ì „ê¸°ì¥ ë°ì´í„° ìƒì„±

#### ì£¼ìš” ê¸°ëŠ¥:
- **ì…ë ¥**: 
  - `twin_cons_cathodicfirst_400us_100Hz_single10ms_Ex/` í´ë” (201ê°œ íŒŒì¼)
  - `twin_cons_cathodicfirst_400us_100Hz_single10ms_Ez/` í´ë” (201ê°œ íŒŒì¼)
  
- **ì²˜ë¦¬ ê³¼ì •**:
  1. ê° í´ë”ì—ì„œ 001.txt ~ 201.txt íŒŒì¼ì„ ì‹œê°„ ìˆœì„œëŒ€ë¡œ ë¡œë“œ
  2. ê° íŒŒì¼ì€ ê³µê°„ ê·¸ë¦¬ë“œ ì§€ì (14,641ê°œ)ì˜ ì „ê¸°ì¥ ê°’ì„ í¬í•¨
  3. 1ì‚¬ì´í´(201ê°œ ì‹œê°„ ìŠ¤í…) ë°ì´í„°ë¥¼ `np.tile()`ë¡œ 40ì‚¬ì´í´(8040ê°œ ì‹œê°„ ìŠ¤í…)ë¡œ í™•ì¥
  4. Exì™€ Ez ì„±ë¶„ì„ ìŠ¤íƒí•˜ì—¬ ìµœì¢… ë°°ì—´ ìƒì„±

- **ì¶œë ¥**: 
  - `E_field_40cycles.npy`
  - Shape: `(2, 14641, 8040)`
    - ì°¨ì› 0: Ex(0), Ez(1)
    - ì°¨ì› 1: ê³µê°„ ê·¸ë¦¬ë“œ ì§€ì  ìˆ˜ (14,641ê°œ)
    - ì°¨ì› 2: ì‹œê°„ ìŠ¤í… (8040ê°œ = 201 Ã— 40)

#### ì½”ë“œ í•µì‹¬:
```python
# 1ì‚¬ì´í´ ë°ì´í„° ë¡œë“œ
E_x_1cycle = load_and_combine_e_field_data(EX_DIR, total_steps=201)
E_z_1cycle = load_and_combine_e_field_data(EZ_DIR, total_steps=201)

# 40ì‚¬ì´í´ë¡œ í™•ì¥
E_x_40cycles = np.tile(E_x_1cycle, (1, 40))
E_z_40cycles = np.tile(E_z_1cycle, (1, 40))

# ìµœì¢… ë°°ì—´ ìƒì„±
E_field_40cycles = np.stack((E_x_40cycles, E_z_40cycles), axis=0)
```

---

### 2. **extract_coords.py**
**ì—­í• **: Ansys í…ìŠ¤íŠ¸ íŒŒì¼ì—ì„œ ê³µê°„ ì¢Œí‘œ(X, Y, Z) ì¶”ì¶œ

#### ì£¼ìš” ê¸°ëŠ¥:
- **ì…ë ¥**: `twin_cons_cathodicfirst_400us_100Hz_single10ms_Ex/001.txt` (ë˜ëŠ” Ez í´ë”ì˜ ì²« ë²ˆì§¸ íŒŒì¼)
- **ì²˜ë¦¬**:
  1. í…ìŠ¤íŠ¸ íŒŒì¼ì˜ í—¤ë” 2ì¤„ ìŠ¤í‚µ
  2. ê³µë°±/íƒ­ìœ¼ë¡œ êµ¬ë¶„ëœ ë°ì´í„°ì—ì„œ X, Y, Z ì¢Œí‘œ(ì²« 3ì—´) ì¶”ì¶œ
  3. ì¢Œí‘œëŠ” ë¯¸í„°(M) ë‹¨ìœ„ë¡œ ì €ì¥ë˜ì–´ ìˆìŒ

- **ì¶œë ¥**: 
  - `E_field_grid_coords.npy`
  - Shape: `(14641, 3)` - ê° í–‰ì€ (X, Y, Z) ì¢Œí‘œ

#### ì½”ë“œ í•µì‹¬:
```python
df_coords = pd.read_csv(file_path, skiprows=2, sep=r'\s+', 
                       header=None, engine='python').iloc[:, 0:3]
grid_coords = df_coords.values.astype(np.float64)
np.save(output_path, grid_coords)
```

---

### 3. **Extractedfilecheck.py**
**ì—­í• **: ìƒì„±ëœ `E_field_40cycles.npy` íŒŒì¼ì˜ ë¬´ê²°ì„± ê²€ì¦

#### ê²€ì¦ í•­ëª©:
1. **Shape í™•ì¸**: `(2, N_spatial, 8040)` í˜•ì‹ì¸ì§€ í™•ì¸
2. **ë°˜ë³µì„± í™•ì¸**: 1ì£¼ê¸°ì™€ 2ì£¼ê¸° ë°ì´í„°ê°€ ë™ì¼í•œì§€ í™•ì¸
3. **ë°ì´í„° ë¬´ê²°ì„±**: NaN ë˜ëŠ” Inf ê°’ì´ ì—†ëŠ”ì§€ í™•ì¸
4. **ìµœì†Œ/ìµœëŒ€ê°’**: ë°ì´í„° ë²”ìœ„ í™•ì¸

---

### 4. **simple_pyramidal_model.py**
**ì—­í• **: ì¼ì§ì„  í¥ë¶„ì„± ë‰´ëŸ° ëª¨ë¸ ì •ì˜

#### ë‰´ëŸ° êµ¬ì¡°:
- **Soma (ì„¸í¬ì²´)**:
  - ì§€ë¦„: 30 Î¼m
  - ê¸¸ì´: 30 Î¼m
  - ìœ„ì¹˜: ì‚¬ìš©ì ì§€ì • (x, y, z_center)

- **Axon (ì¶•ì‚­ëŒê¸°)**:
  - ê¸¸ì´: 1000 Î¼m (Zì¶• ë°©í–¥)
  - ì§€ë¦„: 1 Î¼m
  - êµ¬íš ìˆ˜: 50ê°œ (Extracellular ê³„ì‚°ì„ ìœ„í•´ ì„¸ë¶„í™”)
  - ì—°ê²°: Soma ì¤‘ì•™(0.5)ì— ì—°ê²°

#### ì „ê¸°ì  íŠ¹ì„±:
- **Hodgkin-Huxley ëª¨ë¸** (`hh` ë©”ì»¤ë‹ˆì¦˜):
  - Na ì±„ë„: `gnabar_hh = 0.3 S/cmÂ²`
  - K ì±„ë„: `gkbar_hh = 0.036 S/cmÂ²`
  - ëˆ„ì„¤: `gl_hh = 0.0003 S/cmÂ²`, `el_hh = -65.0 mV`
  
- **Extracellular ë©”ì»¤ë‹ˆì¦˜**: ì™¸ë¶€ ì „ê¸°ì¥ ì ìš©ì„ ìœ„í•´ í•„ìˆ˜

#### ì½”ë“œ í•µì‹¬:
```python
class SimplePyramidal:
    def __init__(self, x, y, z_center):
        # Somaì™€ Axon ìƒì„±
        self.soma = h.Section(name='soma')
        self.axon = h.Section(name='axon')
        
        # 3D ì¢Œí‘œ ì„¤ì • (Zì¶• ë°©í–¥ ì¼ì§ì„ )
        self._set_geometry(x, y, z_center)
        
        # ì „ê¸°ì  ë©”ì»¤ë‹ˆì¦˜ ì‚½ì…
        self._insert_mechanisms()
```

---

### 5. **simulate_tES.py** â­ **ë©”ì¸ ì‹œë®¬ë ˆì´ì…˜ íŒŒì¼**
**ì—­í• **: NEURON ì‹œë®¬ë ˆì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì „ê¸°ì¥ì— ëŒ€í•œ ë‰´ëŸ° ë°˜ì‘ ì‹œë®¬ë ˆì´ì…˜

#### ì „ì²´ ì‹œë®¬ë ˆì´ì…˜ í”Œë¡œìš°:

##### **5.1 ë°ì´í„° ë¡œë“œ**
```python
# E-field ê°’ ë¡œë“œ: (2, 14641, 8040)
E_field_values = np.load('E_field_40cycles.npy')

# E-field ì¢Œí‘œ ë¡œë“œ: (14641, 3) [ë¯¸í„° ë‹¨ìœ„]
E_grid_coords_M = np.load('E_field_grid_coords.npy')
E_grid_coords_UM = E_grid_coords_M * 1e6  # ë¯¸í„° â†’ ë§ˆì´í¬ë¡œë¯¸í„° ë³€í™˜
```

##### **5.2 ê³µê°„ ë§¤í•‘ í•¨ìˆ˜**
```python
def find_nearest_spatial_index(x_um, y_um, z_um, grid_coords_um):
    """ë‰´ëŸ° ì„¸ê·¸ë¨¼íŠ¸ì˜ 3D ì¢Œí‘œì— ê°€ì¥ ê°€ê¹Œìš´ E-field ê·¸ë¦¬ë“œ ì§€ì  ì°¾ê¸°"""
    distances_sq = np.sum((grid_coords_um - target_coord)**2, axis=1)
    nearest_index = np.argmin(distances_sq)
    return nearest_index
```

##### **5.3 ì‹œê°„ ë§¤í•‘ ë° E-field ì ìš© í•¨ìˆ˜** (í•µì‹¬!)
```python
def set_extracellular_field():
    """ë§¤ ì‹œê°„ ìŠ¤í…ë§ˆë‹¤ í˜¸ì¶œë˜ì–´ ë‰´ëŸ°ì— E-field ì ìš©"""
    
    # 1. í˜„ì¬ ì‹œê°„ â†’ ì‹œê°„ ì¸ë±ìŠ¤ ë³€í™˜
    current_time_ms = h.t
    time_index_float = current_time_ms / TIME_STEP_MS  # 0.05ms ê°„ê²©
    
    # 2. ì„ í˜• ë³´ê°„ì„ ìœ„í•œ ì´ì „/ë‹¤ìŒ ì¸ë±ìŠ¤
    t_idx_prev = int(math.floor(time_index_float))
    t_idx_next = min(t_idx_prev + 1, E_field_values.shape[2] - 1)
    ratio = time_index_float - t_idx_prev
    
    # 3. ëª¨ë“  ë‰´ëŸ°ì˜ ëª¨ë“  ì„¸ê·¸ë¨¼íŠ¸ì— ì ìš©
    for neuron in neurons:
        for sec in neuron.all:
            for seg in sec.allseg():
                # 3-1. ê³µê°„ ë§¤í•‘ (ìºì‹œ ì‚¬ìš©)
                seg_id = (sec.name(), seg.x)
                if seg_id not in global_spatial_map:
                    sec_x = h.x3d(seg.x, sec=sec)
                    sec_y = h.y3d(seg.x, sec=sec)
                    sec_z = h.z3d(seg.x, sec=sec)
                    nearest_idx = find_nearest_spatial_index(
                        sec_x, sec_y, sec_z, E_grid_coords_UM)
                    global_spatial_map[seg_id] = nearest_idx
                
                spatial_idx = global_spatial_map[seg_id]
                
                # 3-2. ì‹œê°„ ë³´ê°„ìœ¼ë¡œ Ex, Ez ê°’ ê³„ì‚°
                Ex_prev = E_field_values[0, spatial_idx, t_idx_prev]
                Ex_next = E_field_values[0, spatial_idx, t_idx_next]
                Ez_prev = E_field_values[1, spatial_idx, t_idx_prev]
                Ez_next = E_field_values[1, spatial_idx, t_idx_next]
                
                Ex_interp = Ex_prev + ratio * (Ex_next - Ex_prev)
                Ez_interp = Ez_prev + ratio * (Ez_next - Ez_prev)
                
                # 3-3. Extracellular ì „ìœ„ ì„¤ì •
                # E-field (V/m) â†’ NEURON ë‹¨ìœ„ (mV/um) ë³€í™˜
                E_factor = 1e-3  # 1 V/m = 1e-3 mV/um
                # ì¶•ì‚­ëŒê¸°ê°€ Zì¶• ë°©í–¥ì´ë¯€ë¡œ Ezë§Œ ì‚¬ìš©
                seg.e_extracellular = -Ez_interp * E_factor * (seg.sec.L / seg.sec.nseg)
```

**ì¤‘ìš” í¬ì¸íŠ¸**:
- **íƒ€ì„í¬ì¸íŠ¸ë§ˆë‹¤ ì„ ì ë¶„**: ê° ì‹œê°„ ìŠ¤í…ì—ì„œ E-field ê°’ì„ ë³´ê°„í•˜ì—¬ ì ìš©
- **ê³µê°„ ë§¤í•‘ ìµœì í™”**: ì„¸ê·¸ë¨¼íŠ¸ë³„ë¡œ ê°€ì¥ ê°€ê¹Œìš´ ê·¸ë¦¬ë“œ ì§€ì ì„ ìºì‹œí•˜ì—¬ ì¬ì‚¬ìš©
- **ì‹œê°„ ë³´ê°„**: ì´ì‚° ë°ì´í„°ë¥¼ ì—°ì†ì ìœ¼ë¡œ ì ìš©í•˜ê¸° ìœ„í•´ ì„ í˜• ë³´ê°„ ì‚¬ìš©

##### **5.4 ë‰´ëŸ° ìƒì„± ë° ë°°ì¹˜**
```python
# 3ê°œ ë‰´ëŸ° ìƒì„± (ì¼ì§ì„  í¥ë¶„ì„± ë‰´ëŸ°)
N_POSITIONS = [
    (-90.0 * um, 42.0 * um, 561.0 * um),  # Neuron 1
    (0.0 * um, 42.0 * um, 561.0 * um),    # Neuron 2
    (90.0 * um, 42.0 * um, 561.0 * um)    # Neuron 3
]

neurons = []
for i, (x, y, z) in enumerate(N_POSITIONS):
    neuron = SimplePyramidal(x=x, y=y, z_center=z)
    neurons.append(neuron)
```

##### **5.5 ì‹œë®¬ë ˆì´ì…˜ ì‹¤í–‰**
```python
# ì‹œë®¬ë ˆì´ì…˜ íŒŒë¼ë¯¸í„°
h.tstop = 402.0 * ms      # 40ì‚¬ì´í´ Ã— 10ms = 400ms + ì—¬ìœ 
h.dt = 0.025 * ms         # ì‹œê°„ ê°„ê²© (Ansys ê°„ê²© 50usì˜ 1/2)
h.celsius = 34.0          # ìƒì²´ ì˜¨ë„
h.finitialize(-65.0 * mV)  # ì´ˆê¸° ë§‰ ì „ìœ„

# ì‹œë®¬ë ˆì´ì…˜ ë£¨í”„
while h.t < h.tstop:
    t_vec.append(h.t)
    
    # ê° ë‰´ëŸ°ì˜ Soma ì „ìœ„ ê¸°ë¡
    for i, neuron in enumerate(neurons):
        Vm_vecs[i].append(neuron.soma(0.5).v)
    
    # E-field ì—…ë°ì´íŠ¸ (ë§¤ ì‹œê°„ ìŠ¤í…ë§ˆë‹¤)
    set_extracellular_field()
    
    # ì‹œê°„ ì „ì§„
    h.fadvance()
```

##### **5.6 ê²°ê³¼ ì €ì¥**
- ê° ë‰´ëŸ°ì˜ Soma ë§‰ ì „ìœ„(Vm)ë¥¼ ì‹œê°„ì— ë”°ë¼ ê¸°ë¡
- `simulate_tES_output/` í´ë”ì— ê·¸ë˜í”„ ì €ì¥:
  - `neuron_1_response.png`
  - `neuron_2_response.png`
  - `neuron_3_response.png`

---

## ğŸ” í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜ ìƒì„¸ ì„¤ëª…

### **ì „ê¸°ì¥ ì ìš© ì›ë¦¬**

1. **Ansys ë°ì´í„° í˜•ì‹**:
   - ê° ì‹œê°„ ìŠ¤í…(50Î¼s ê°„ê²©)ë§ˆë‹¤ ê³µê°„ ê·¸ë¦¬ë“œ(14,641ê°œ ì§€ì )ì˜ Ex, Ez ê°’
   - 1ì‚¬ì´í´ = 10ms = 201ê°œ ì‹œê°„ ìŠ¤í…
   - 40ì‚¬ì´í´ = 400ms = 8040ê°œ ì‹œê°„ ìŠ¤í…

2. **ê³µê°„ ë§¤í•‘**:
   - ë‰´ëŸ°ì˜ ê° ì„¸ê·¸ë¨¼íŠ¸ ìœ„ì¹˜ (x, y, z)ë¥¼ E-field ê·¸ë¦¬ë“œ ì¢Œí‘œì™€ ë§¤ì¹­
   - ê°€ì¥ ê°€ê¹Œìš´ ê·¸ë¦¬ë“œ ì§€ì ì˜ E-field ê°’ì„ ì‚¬ìš©
   - ìµœì í™”: í•œ ë²ˆ ê³„ì‚°í•œ ë§¤í•‘ì€ ìºì‹œì— ì €ì¥

3. **ì‹œê°„ ë³´ê°„**:
   - NEURONì˜ ì‹œê°„ ìŠ¤í…(0.025ms)ì´ Ansys ë°ì´í„° ê°„ê²©(0.05ms)ë³´ë‹¤ ì‘ìŒ
   - ì„ í˜• ë³´ê°„ìœ¼ë¡œ ì¤‘ê°„ ì‹œê°„ì˜ E-field ê°’ ê³„ì‚°

4. **Extracellular ì „ìœ„ ê³„ì‚°**:
   - E-field (V/m)ë¥¼ NEURON ë‹¨ìœ„ (mV/Î¼m)ë¡œ ë³€í™˜
   - ì¶•ì‚­ëŒê¸°ê°€ Zì¶• ë°©í–¥ì´ë¯€ë¡œ **Ez ì„±ë¶„ë§Œ ì‚¬ìš©**
   - `seg.e_extracellular`ì— ì„¤ì •í•˜ì—¬ NEURONì´ ìë™ìœ¼ë¡œ ê³„ì‚°

### **ë‰´ëŸ° ëª¨ë¸ íŠ¹ì§•**

- **ì¼ì§ì„  í¥ë¶„ì„± ë‰´ëŸ°**:
  - Soma + Axon êµ¬ì¡°
  - Axonì€ Zì¶• ë°©í–¥ìœ¼ë¡œ 1000Î¼m ê¸¸ì´
  - Hodgkin-Huxley ëª¨ë¸ë¡œ ë°œí™” ë©”ì»¤ë‹ˆì¦˜ êµ¬í˜„

- **3ê°œ ë‰´ëŸ° ë°°ì¹˜**:
  - Xì¶• ë°©í–¥ìœ¼ë¡œ -90Î¼m, 0Î¼m, +90Î¼m ìœ„ì¹˜
  - Y, Z ì¢Œí‘œëŠ” ë™ì¼ (42Î¼m, 561Î¼m)
  - ì „ê¸°ì¥ì˜ ê³µê°„ì  ì°¨ì´ì— ë”°ë¥¸ ë°˜ì‘ ë¹„êµ

---

## ğŸ“Š ë°ì´í„° íë¦„ ìš”ì•½

| ë‹¨ê³„ | ì…ë ¥ | ì²˜ë¦¬ | ì¶œë ¥ |
|------|------|------|------|
| **1. ë°ì´í„° í™•ì¥** | Ex/Ez í´ë” (201ê°œ íŒŒì¼) | 40ì‚¬ì´í´ë¡œ í™•ì¥ | `E_field_40cycles.npy` |
| **2. ì¢Œí‘œ ì¶”ì¶œ** | Ex/001.txt | ì¢Œí‘œ ì¶”ì¶œ | `E_field_grid_coords.npy` |
| **3. ë°ì´í„° ê²€ì¦** | `E_field_40cycles.npy` | ë¬´ê²°ì„± í™•ì¸ | ê²€ì¦ ê²°ê³¼ ì¶œë ¥ |
| **4. ì‹œë®¬ë ˆì´ì…˜** | E-field ë°ì´í„° + ë‰´ëŸ° ëª¨ë¸ | NEURON ì‹œë®¬ë ˆì´ì…˜ | Vm ì‹œê°„ ì‹œë¦¬ì¦ˆ + ê·¸ë˜í”„ |

---

## ğŸ¯ ì‹¤í–‰ ìˆœì„œ (ì‚¬ìš©ì ê°€ì´ë“œ)

1. **Singlecycletoncycle_npyextractor.ipynb ì‹¤í–‰**
   - 40ì‚¬ì´í´ ë°ì´í„° ìƒì„± (`E_field_40cycles.npy`)
   - ë§ˆìš´íŠ¸ë§Œ í•˜ë©´ ë˜ë¯€ë¡œ ì½”ë“œ ë³€ê²½ ë¶ˆí•„ìš”

2. **extract_coords.py ì‹¤í–‰** (VSCode ë˜ëŠ” í„°ë¯¸ë„)
   - ì¢Œí‘œ ì¶”ì¶œ (`E_field_grid_coords.npy`)
   - `twin_cons_cathodicfirst_400us_100Hz_single10ms_Ex/001.txt` ì‚¬ìš©

3. **Extractedfilecheck.py ì‹¤í–‰** (ê²€ì¦)
   - ìƒì„±ëœ ë°ì´í„° íŒŒì¼ ê²€ì¦

4. **simulate_tES.py ì‹¤í–‰**
   - NEURON ì‹œë®¬ë ˆì´ì…˜ ìˆ˜í–‰
   - ê²°ê³¼ëŠ” `simulate_tES_output/` í´ë”ì— ì €ì¥

---

## ğŸ”§ ì£¼ìš” íŒŒë¼ë¯¸í„°

### **ì‹œê°„ ê´€ë ¨**
- Ansys ì‹œê°„ ê°„ê²©: 50Î¼s (0.05ms)
- NEURON ì‹œê°„ ê°„ê²©: 25Î¼s (0.025ms)
- 1ì‚¬ì´í´ ê¸¸ì´: 10ms (201ê°œ ìŠ¤í…)
- ì´ ì‹œë®¬ë ˆì´ì…˜ ì‹œê°„: 402ms (40ì‚¬ì´í´)

### **ê³µê°„ ê´€ë ¨**
- E-field ê·¸ë¦¬ë“œ ì§€ì  ìˆ˜: 14,641ê°œ
- ë‰´ëŸ° ìˆ˜: 3ê°œ
- Axon ê¸¸ì´: 1000Î¼m
- Axon êµ¬íš ìˆ˜: 50ê°œ

### **ì „ê¸°ì  íŒŒë¼ë¯¸í„°**
- ì´ˆê¸° ë§‰ ì „ìœ„: -65mV
- ì˜¨ë„: 34Â°C
- Na ì±„ë„: 0.3 S/cmÂ²
- K ì±„ë„: 0.036 S/cmÂ²

---

## ğŸ“ ì£¼ì˜ì‚¬í•­

1. **ë‹¨ìœ„ ë³€í™˜**:
   - Ansys ì¢Œí‘œëŠ” ë¯¸í„°(M) ë‹¨ìœ„ â†’ NEURONì€ ë§ˆì´í¬ë¡œë¯¸í„°(Î¼m) ë‹¨ìœ„
   - E-fieldëŠ” V/m ë‹¨ìœ„ â†’ NEURONì€ mV/Î¼m ë‹¨ìœ„

2. **Ezë§Œ ì‚¬ìš©**:
   - í˜„ì¬ êµ¬í˜„ì€ ì¶•ì‚­ëŒê¸°ê°€ Zì¶• ë°©í–¥ì´ë¯€ë¡œ Ez ì„±ë¶„ë§Œ ì‚¬ìš©
   - ExëŠ” ë¬´ì‹œë¨ (ì½”ë“œ ì£¼ì„ ì°¸ì¡°)

3. **ê³µê°„ ë§¤í•‘ ìµœì í™”**:
   - `global_spatial_map` ë”•ì…”ë„ˆë¦¬ë¡œ ë§¤í•‘ ê²°ê³¼ ìºì‹œ
   - ì²« ê³„ì‚° í›„ ì¬ì‚¬ìš©í•˜ì—¬ ì„±ëŠ¥ í–¥ìƒ

4. **ì‹œê°„ ë³´ê°„**:
   - ì„ í˜• ë³´ê°„ ì‚¬ìš©
   - ê²½ê³„ ì²˜ë¦¬: ë§ˆì§€ë§‰ ì¸ë±ìŠ¤ ì´ˆê³¼ ë°©ì§€

---

## ğŸ“ ì°¸ê³  ì •ë³´

- **tES (Transcranial Electrical Stimulation)**: ë‘ê°œê³¨ì„ í†µí•œ ì „ê¸° ìê·¹
- **NEURON ì‹œë®¬ë ˆì´í„°**: ë‰´ëŸ° ì „ê¸°ìƒë¦¬í•™ ì‹œë®¬ë ˆì´ì…˜ ì†Œí”„íŠ¸ì›¨ì–´
- **Hodgkin-Huxley ëª¨ë¸**: ë‰´ëŸ°ì˜ ì´ì˜¨ ì±„ë„ ë™ì—­í•™ ëª¨ë¸
- **Extracellular ë©”ì»¤ë‹ˆì¦˜**: NEURONì—ì„œ ì™¸ë¶€ ì „ê¸°ì¥ ì ìš© ë©”ì»¤ë‹ˆì¦˜

---

## ğŸ“Œ ìš”ì•½

ì´ í”„ë¡œì íŠ¸ëŠ” **Ansysì—ì„œ ê³„ì‚°ëœ ì „ê¸°ì¥ ë°ì´í„°ë¥¼ NEURON ì‹œë®¬ë ˆì´í„°ì— ì ìš©í•˜ì—¬ ì¼ì§ì„  í¥ë¶„ì„± ë‰´ëŸ°ì˜ ë°˜ì‘ì„ ì‹œë®¬ë ˆì´ì…˜**í•˜ëŠ” íŒŒì´í”„ë¼ì¸ì…ë‹ˆë‹¤. 

í•µì‹¬ì€ **íƒ€ì„í¬ì¸íŠ¸ë§ˆë‹¤ ì„ ì ë¶„**í•˜ì—¬ E-fieldë¥¼ ë‰´ëŸ° ì„¸ê·¸ë¨¼íŠ¸ì— ì ìš©í•˜ëŠ” ê²ƒì´ë©°, ì´ë¥¼ í†µí•´ ì „ê¸° ìê·¹ì— ëŒ€í•œ ë‰´ëŸ°ì˜ ë§‰ ì „ìœ„ ë³€í™”ë¥¼ ì‹œê°„ì— ë”°ë¼ ì¶”ì í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
